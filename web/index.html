<!doctype html>
<html lang="sv">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Skolplanering Göteborg</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,500;9..144,700&family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css" />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="glow glow-left" aria-hidden="true"></div>
    <div class="glow glow-right" aria-hidden="true"></div>

    <header class="topbar">
      <div class="title-wrap">
        <p class="overline">Planeringsstudio</p>
        <h1>Skolplanering Göteborg</h1>
      </div>
      <div class="controls">
        <label>År
          <select id="yearSelect"></select>
        </label>
        <label>Scenario
          <select id="scenarioSelect">
            <option value="base">Bas</option>
            <option value="low">Låg</option>
            <option value="high">Hög</option>
          </select>
        </label>
        <button id="runPlanningBtn">Kör årsplan</button>
      </div>
    </header>

    <nav class="tabs">
      <button class="tab active" data-tab="overview">Översikt</button>
      <button class="tab" data-tab="forecast">Prognos</button>
      <button class="tab" data-tab="map">Karta</button>
      <button class="tab" data-tab="planning">Kapacitetsplan</button>
      <button class="tab" data-tab="export">Export</button>
    </nav>

    <section class="demo-guide" id="demoGuide">
      <div class="demo-copy">
        <p class="demo-kicker">Guidad demo</p>
        <h3 id="demoStepTitle">Steg 1: Nuläge och kapacitetsbalans</h3>
        <p id="demoStepText">Visa hur många elever som förväntas i år och vilka distrikt som redan har underskott.</p>
      </div>
      <button id="demoNextBtn">Nästa steg</button>
    </section>

    <main>
      <section id="overview" class="panel active">
        <div class="panel-header">
          <h2>Kapacitetsbalans</h2>
          <p>Helhetsbild för elevantal, kapacitet och balans mellan stadens distrikt.</p>
        </div>
        <div class="kpi-grid">
          <article class="kpi-card"><h3>Totalt elevantal</h3><p id="kpiStudents">-</p></article>
          <article class="kpi-card"><h3>Total kapacitet</h3><p id="kpiCapacity">-</p></article>
          <article class="kpi-card"><h3>Beläggning</h3><p id="kpiUtilization">-</p></article>
          <article class="kpi-card"><h3>Överskott/Underskott</h3><p id="kpiSurplus">-</p></article>
        </div>
        <div class="insight-grid">
          <article class="insight-card">
            <h3>Efterfrågan till 2036</h3>
            <p id="insightDemandChange">-</p>
          </article>
          <article class="insight-card">
            <h3>Högst risk just nu</h3>
            <p id="insightRiskDistrict">-</p>
          </article>
          <article class="insight-card">
            <h3>Föreslagen huvudåtgärd</h3>
            <p id="insightAction">-</p>
          </article>
        </div>
        <div class="spotlight-shell">
          <h3>Distrikt i fokus</h3>
          <ul id="spotlightList"></ul>
        </div>
        <div class="table-shell">
          <table id="districtTable">
            <thead>
              <tr><th>Distrikt</th><th>Kapacitet</th><th>Efterfrågan</th><th>Balans</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section id="forecast" class="panel">
        <div class="panel-header">
          <h2>Prognos 2026-2036</h2>
          <p>Scenariofiltret uppdaterar prognoskurvan för hela staden.</p>
        </div>
        <div class="chart-shell">
          <canvas id="forecastChart" height="110"></canvas>
        </div>
        <div class="table-shell compare-shell">
          <table>
            <thead>
              <tr><th>Scenario</th><th>Elevantal 2036</th><th>Förändring från 2026</th></tr>
            </thead>
            <tbody id="forecastCompareBody"></tbody>
          </table>
        </div>
      </section>

      <section id="map" class="panel">
        <div class="panel-header">
          <h2>Karta</h2>
          <p>Distriktsgränser och skolor ovanpå OpenStreetMap.</p>
        </div>
        <div id="mapView"></div>
      </section>

      <section id="planning" class="panel">
        <div class="panel-header">
          <h2>Rekommendationer</h2>
          <p>Årsvisa förslag byggda på valda begränsningar.</p>
        </div>
        <div class="constraints">
          <label>Max klassstorlek <input id="classSize" type="number" /></label>
          <label>Max avstånd (km) <input id="maxDistance" type="number" step="0.1" /></label>
          <label>Min byggnadsskick <input id="minCondition" type="number" /></label>
          <button id="saveConstraintsBtn">Spara</button>
        </div>
        <div class="planning-summary">
          <article><h3>Antal förslag</h3><p id="recTotalCount">-</p></article>
          <article><h3>Hög tilltro</h3><p id="recHighConfidence">-</p></article>
          <article><h3>Proaktiv andel</h3><p id="recProactiveShare">-</p></article>
        </div>
        <div class="table-shell">
          <table id="recsTable">
            <thead>
              <tr><th>Åtgärd</th><th>Tilltro</th><th>Distrikt</th><th>Skola</th><th>Effekt elever</th><th>Effekt kapacitet</th><th>Motivering</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section id="export" class="panel">
        <div class="panel-header">
          <h2>Export</h2>
          <p>Ladda ner CSV-filer som kan öppnas direkt i Excel.</p>
        </div>
        <div class="export-buttons">
          <button data-export="district_capacity">Export Distrikt</button>
          <button data-export="school_utilization">Export Skolor</button>
          <button data-export="recommendations">Export Rekommendationer</button>
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>
    <script src="/app.js"></script>
  </body>
</html>
